  <!DOCTYPE html> 
  <html>
  <head>
    {% load staticfiles %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="{% static "icons/stethoscope.ico" %}" />
  <script language="JavaScript" src="//ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script>
    $(document).bind("mobileinit", function(){
      $.mobile.ajaxEnabled = false;
      $.mobile.pushStateEnabled = false;
    });
  </script>
  <script async language="JavaScript" src="//ajax.googleapis.com/ajax/libs/jquerymobile/1.4.3/jquery.mobile.min.js"></script>
  <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jquerymobile/1.4.3/jquery.mobile.min.css" />
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static "style/style.css" %}"rel="stylesheet" type="text/css" />
  </head>
  <body>
  <div data-role="page" id="userProfile" data-title="{{data.patient.user.username}} | Doctors Info. Pakistan">
     <div data-role="header" class="header1">
      <span id="logo" data-role="none"><a href="/"><img height="35" src="{% static "icons/doctors.png" %}" alt="logo"/></a></span>
       <div id="head">
        {% if data.user.is_authenticated %}
        <a href="/logout/" style: id="user" >Log Out.</a>
        {% endif %}
      </div>
    </div>
    <div role="main" class="ui-content container">
     {% if data.user.is_authenticated %}
     <h2 class="textCentre">User Profile</h2>
     <!--Patient Profile -->
     <div class="profile">
       <ul>
         <li>
           <span>username: <strong>{{data.patient.user.username}}</strong></span>
           <span>email: <strong>{{data.patient.user.email}}</strong></span>
           {% if data.patient.user.get_full_name and data.patient.cell_number %}
           <span>First name: <strong>{{data.patient.user.first_name}}</strong></span>
           <span>Last Name: <strong>{{data.patient.user.last_name}}</strong></span>
           <span>Cell Number: {{data.patient.cell_number}}</span>
           <span>Gender: {{data.patient.get_gender_display}}</span>
           <span>Age-Group: {{data.patient.get_age_group_display}}</span>
           {% else %}
           <form action="{% url 'patient' %}" class="updateP" method="POST">{% csrf_token %}
            <input type="hidden" name="type_" value="updatePatient" />
            <span><strong>First Name: <input type="text" name="fname" required /></strong></span>
            <span><strong>Last Name: <input type="text" name="lname" required /></strong></span>
            <span><strong>Cell Number: <input type="text" name="number" /></strong></span>
            <span><strong>Gender: </strong><select name="gender">
             <option value="-">Prefer not to answer</option>
             <option value="M">Male</option><option value="F">Female</option>
           </select></span>
           <span><strong>Age Group: </strong><select name="age" required><option value="">-Select Age Group-</option>
             <option value="10">10-14</option><option value="15">15-19</option><option value="20">20-24</option>
             <option value="25">25-29</option><option value="30">30-34</option><option value="35">35-39</option>
             <option value="40">40-44</option><option value="45">45-49</option><option value="50">50-54</option>
             <option value="55">55-59</option><option value="60">60-64</option><option value="65">65-69</option>
             <option value="80">80-84</option><option value="85">85+</option>
           </select></span>
           <button type="submit" id="post-review-btn" class="ui-btn ui-corner-all ui-btn-a">Update</button>
         </form>
         {% endif %}
       </li>
     </ul>
   </div> 

   <!--patient reviews-->
   <div class="grid-name">
     <h2 style="background-color: #4b555d;">Reviews</h2>
     <div class="patient-reviews">
       <ul>
         {% for pr in data.reviews.iterator %}
         <li class="marg-l">
           <span class="comment" contenteditable="true">{{pr.review_text}}</span>
           <i class="fa fa-trash fa-1x review" id="{{pr.pk}}"></i>
           <i class="fa fa-check updatereview" id="{{pr.pk}}"></i>
         </li>
         {% empty %}
         <li class="marg-l"><span>* No Reviews from you about any Practitioner.</span></li>
         {% endfor %}
       </ul>
       <p>* Tap on review text to update and then click Check Button to Save.</p>
     </div>
   </div>

   <!--favourite Practitioner List -->
   <div class="grid-name">
     <h2 style="background-color: #4b555d;">Favourite Practitioners</h2>
     <div class="favourite-pracs">
      <ul>
       {% for practitioner in data.patient.favt_practitioner.all.iterator %}
       <li><a href="{% url 'practitioner' practitioner.slug %}" class="anchor-link Pracname" >* {{practitioner.name}}</a><i class="fa fa-times fa-1x deletePrac" id="{{practitioner.slug}}"></i></li>
       {% empty %}
       <li class="marg-l"><span>* No favourite Practitioner. *</span></li>
       {% endfor %}
     </ul>
   </div>
 </div>

    <!-- No user login-->
    {% else %}
    <center><a href="/login/" class="ui-btn ui-corner-all ui-shadow loginSignup">Login</a></center>
    <center><a href="/register/" class="ui-btn ui-corner-all ui-shadow loginSignup">Sign Up</a></center>
    <center><a href="/password/reset/" class="ui-btn ui-corner-all ui-shadow loginSignup">Forgot Password</a></center>
    {% endif %}
  </div>
  <!-- Footer Details -->
  <div class="foot" data-role="footer">
    <h4>
      <a href="https://www.facebook.com/doctorsinfo.pk" target="_blank"><i class="fa fa-facebook fa-1x"></i></a>
      <a href="mailto:doctorsinfo.pk@gmail.com"><i class="fa fa-envelope fa-1x"></i></a>
      <a href="http://twitter.com/doctorsinfo_pk" target="_blank"><i class="fa fa-twitter fa-1x"></i></a>
      <a href="https://plus.google.com/114638856531345672910" target="_blank"><i class="fa fa-google-plus fa-1x"></i></a>
    </h4>
  </div>
<script type="application/javascript">
/* remove Review */
$(document).on("pageshow", "#userProfile", function () {
  $('.review').click(function() {
    var warning = window.confirm("Are you sure you want to remove that Review ?");
    if (warning){
      $.ajax({
        type: "POST",
        url: "{% url 'patient' %}",
        context: this,
        data: {
          type_: "deleteReview",
          id: $(this).attr('id'),
          csrfmiddlewaretoken: '{{ csrf_token }}'
        },
        success: function(data) {
          if (data.status_){  
            var cmnt = $(this).next('.updatereview');
            var check = $(this).prev('.comment');
            cmnt.remove();
            check.remove();
            $(this).remove();
          }
        },
        dataType: 'json'
      });
    }
  });
/* updatereview */
  $('.updatereview').click(function() {
    $.ajax({
      type: "POST",
      url: "{% url 'patient' %}",
      context: this,
      data: {
        type_: "updatereview",
        id: $(this).attr('id'),
        csrfmiddlewaretoken: '{{ csrf_token }}'
      },
      success: function(data) {
        if (data.status_){
          $(this).hide();
        }
      },
      dataType: 'json'
    });
  });
/* remove Prac */
  $('.deletePrac').click(function() {
    var warning = window.confirm("Are you sure you want to remove that Practitioner from your favourite List ?");
    if (warning){
      $.ajax({
        type: "POST",
        context: this,
        url: "{% url 'patient' %}",
        context: this,
        data: {
          type_: "deletePrac",
          prac_slug: $(this).attr('id'),
          csrfmiddlewaretoken: '{{ csrf_token }}'
        },
        success: function(data) {
          if (data.status_){
            var name = $(this).prev('.Pracname');
            name.remove();
            $(this).remove();
          }
        },
      });
    }
  });
});
</script>
</div>
</body>
</html>